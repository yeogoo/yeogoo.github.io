<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">누적매출 구하기 | 여구의 기록 노트</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://yeogoo.github.io/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://yeogoo.github.io/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://yeogoo.github.io/en/blog/누적매출 구하기"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="ko"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="누적매출 구하기 | 여구의 기록 노트"><meta data-rh="true" name="description" content="아래와 같은 주문 테이블이 있다고 하자."><meta data-rh="true" property="og:description" content="아래와 같은 주문 테이블이 있다고 하자."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-01-05T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://yeogoo.github.io"><meta data-rh="true" property="article:tag" content="sql,sqld"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://yeogoo.github.io/en/blog/누적매출 구하기"><link data-rh="true" rel="alternate" href="https://yeogoo.github.io/blog/누적매출 구하기" hreflang="ko"><link data-rh="true" rel="alternate" href="https://yeogoo.github.io/en/blog/누적매출 구하기" hreflang="en"><link data-rh="true" rel="alternate" href="https://yeogoo.github.io/blog/누적매출 구하기" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="여구의 기록 노트 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="여구의 기록 노트 Atom Feed"><link rel="stylesheet" href="/en/assets/css/styles.3a700447.css">
<script src="/en/assets/js/runtime~main.169abad9.js" defer="defer"></script>
<script src="/en/assets/js/main.5ea92f80.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><b class="navbar__title text--truncate">여구의 기록 노트</b></a><a class="navbar__item navbar__link" href="/en/docs/books">독후감</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/yeogoo/yeogoo.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">전체 기록</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/en/blog/kubernetes-the-hard-way-3">kubernetes-the-hard-way (3)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/en/blog/macOS 터미널에서 VS Code 실행시키기">macOS 터미널에서 VS Code 실행시키기</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/en/blog/kubernetes-the-hard-way-1">kubernetes-the-hard-way (1)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/en/blog/kubernetes-the-hard-way-2">kubernetes-the-hard-way (2)</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/en/blog/누적매출 구하기">누적매출 구하기</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/en/blog/giscus 항상 보이게 하기">giscus 항상 보이게 하기</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="아래와 같은 주문 테이블이 있다고 하자."><header><h1 class="title_f1Hy" itemprop="headline">누적매출 구하기</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-01-05T00:00:00.000Z" itemprop="datePublished">January 5, 2024</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://yeogoo.github.io" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/48542008?v=4" alt="yeogoo" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://yeogoo.github.io" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">yeogoo</span></a></div><small class="avatar__subtitle" itemprop="description">블로그 주인장</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>아래와 같은 주문 테이블이 있다고 하자.</p>
<table><thead><tr><th>주문번호</th><th>고객번호</th><th>주문일자</th><th>주문금액</th></tr></thead><tbody><tr><td>501</td><td>1</td><td>20190501</td><td>20000</td></tr><tr><td>612</td><td>1</td><td>20190523</td><td>5000</td></tr><tr><td>728</td><td>1</td><td>20200311</td><td>25000</td></tr><tr><td>904</td><td>1</td><td>20200715</td><td>10000</td></tr><tr><td>404</td><td>2</td><td>20191208</td><td>7000</td></tr><tr><td>603</td><td>2</td><td>20200428</td><td>6000</td></tr><tr><td>807</td><td>2</td><td>20200527</td><td>17000</td></tr></tbody></table>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">고객번호</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문일자</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SUM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">B</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문금액</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> 주문합계금액</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> 주문 A</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 주문 B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> B</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">고객번호 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">고객번호</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> B</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문일자 </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문일자</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">고객번호</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문일자</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">고객번호</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문일자</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>위와 같이 인라인뷰를 통해서 누적 매출을 구하는 방법이 있다. 같은 테이블 간에 조인을 수행하는 것을 셀프 조인이라고 하는데,
위의 경우는 2개의 조건을 사용하였다. 단순히 고객번호로만 조인을 하게 되면 같은 고객번호 내에서 양쪽 집합간에 카티션 곱이 만들어지게 된다.
이때 A쪽의 각 주문 데이터 기준으로 주문일자가 작거나 같은 B쪽 주문을 모두 선택하도록 한 것이다. 실행 결과를 보자.</p>
<table><thead><tr><th style="text-align:left">고객번호</th><th style="text-align:left">주문일자</th><th style="text-align:left">주문합계금액</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:left">20190501</td><td style="text-align:left">20000</td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">20190523</td><td style="text-align:left">25000</td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">20200311</td><td style="text-align:left">50000</td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">20200715</td><td style="text-align:left">60000</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">20191208</td><td style="text-align:left">7000</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">20200428</td><td style="text-align:left">13000</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">20200527</td><td style="text-align:left">30000</td></tr></tbody></table>
<p>위의 쿼리만으로는 주문합계금액이 어떤식으로 도출된지 직관적으로 확인하기 어렵다.
A테이블 (기준 테이블)의 주문금액을 추가해서 확인해보도록 하자.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">고객번호</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문일자</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MIN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문금액</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> 주문금액</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SUM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">B</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문금액</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> 주문합계금액</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> 주문 A</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 주문 B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> B</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">고객번호 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">고객번호</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> B</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문일자 </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문일자</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">고객번호</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문일자</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">고객번호</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">주문일자</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>위 쿼리의 실행결과는 다음과 같다.</p>
<table><thead><tr><th style="text-align:left">고객번호</th><th style="text-align:left">주문일자</th><th style="text-align:left">주문금액</th><th style="text-align:left">주문합계금액</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:left">20190501</td><td style="text-align:left">20000</td><td style="text-align:left">20000</td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">20190523</td><td style="text-align:left">5000</td><td style="text-align:left">25000</td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">20200311</td><td style="text-align:left">25000</td><td style="text-align:left">50000</td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">20200715</td><td style="text-align:left">10000</td><td style="text-align:left">60000</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">20191208</td><td style="text-align:left">7000</td><td style="text-align:left">7000</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">20200428</td><td style="text-align:left">6000</td><td style="text-align:left">13000</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">20200527</td><td style="text-align:left">17000</td><td style="text-align:left">30000</td></tr></tbody></table>
<p>위의 표에서 확인할 수 있듯이 두번째 행인 주문일자 <code>20190523</code>행에서는 <code>20,000 + 5,000 = 25,000</code> 으로 주문합계금액이 집계되는 것을 볼 수 있다.
그 아래의 행도 마찬가지이다.
이해는 가지만 굳이 이렇게 셀프조인까지 사용하면서 누적값을 구해야 하는 걸까? 조금 더 그럴듯하게 작성할 수는 없을까?
답은 <code>윈도우 함수</code>에 있다.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    고객번호</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 주문일자</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">SUM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">주문금액</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> 고객번호 </span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> 고객번호</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 주문일자</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">ROWS</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">BETWEEN</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">UNBOUNDED</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ROW</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> 주문합계금액</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> 주문</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>연습하자.</p>
<p>(SQLD 핵심노트, 디비안, p74~75)</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/sql">sql</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/blog/tags/sqld">sqld</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2024-01-05-누적매출구하기.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/blog/kubernetes-the-hard-way-2"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">kubernetes-the-hard-way (2)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/blog/giscus 항상 보이게 하기"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">giscus 항상 보이게 하기</div></a></nav></main></div></div></div></div>
</body>
</html>